#!/usr/bin/env node
import{a as S,b as w,c,d as C,e as a,f as p,g as b,i as Q}from"../chunk-4FHHKWLN.mjs";import{spawn as V}from"child_process";function x(t){return a(this,null,function*(){return p("Build",t),new Promise((e,o)=>{let r=V("forc",["build","-p",t],{stdio:"inherit"});p("Build"),r.on("exit",s=>{if(!s)return e(s);r.kill(),o()})})})}var T=c(()=>{"use strict";b()});import{runTypeChain as Y,glob as z}from"fuelchain";function f(t){return a(this,null,function*(){let e=process.cwd();console.log(e),console.log(t);let o=z(e,[t.types.artifacts]);yield Y({cwd:e,filesToProcess:o,allFiles:o,outDir:t.types.output,target:"fuels"})})}var v=c(()=>{"use strict"});import{spawn as X}from"child_process";function A(t){return a(this,null,function*(){return new Promise((e,o)=>{let r=X("node_modules/.bin/prettier",["--write",t.types.output.replace(/Ë†\.\//,"")],{stdio:"inherit"});r.on("exit",s=>{if(!s)return e(s);r.kill(),o()})})})}var B=c(()=>{"use strict"});function d(t){return a(this,null,function*(){console.log(t.contracts);for(let{path:e}of t.contracts)yield x(e);yield f(t),yield A(t)})}var h=c(()=>{"use strict";T();v();B()});import{readFileSync as D}from"fs";import{ContractFactory as Z}from"fuels";import k from"path";function tt(t){return`/out/debug/${t.split("/").slice(-1)}.bin`}function ot(t){return`/out/debug/${t.split("/").slice(-1)}-abi.json`}function N(t,e,o){return a(this,null,function*(){if(!t)throw new Error("Cannot deploy without wallet");let r=k.join(e,tt(e)),s=k.join(e,ot(e));p("read binary file from: ",r);let n=D(r),i=JSON.parse(D(s).toString()),H=new Z(n,i,t);p("deploy contract");let K=yield H.deployContract(S({gasLimit:1e6,storageSlots:[]},o));return p("contract successful deployed"),K.id.toB256()})}var O=c(()=>{"use strict";b()});var _=C((Pt,et)=>{et.exports={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}}});var F=C((qt,u)=>{var nt=w("fs"),$=w("path"),rt=w("os"),it=_(),st=it.version,at=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function ct(t){let e={},o=t.toString();o=o.replace(/\r\n?/mg,`
`);let r;for(;(r=at.exec(o))!=null;){let s=r[1],n=r[2]||"";n=n.trim();let i=n[0];n=n.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),i==='"'&&(n=n.replace(/\\n/g,`
`),n=n.replace(/\\r/g,"\r")),e[s]=n}return e}function E(t){console.log(`[dotenv@${st}][DEBUG] ${t}`)}function pt(t){return t[0]==="~"?$.join(rt.homedir(),t.slice(1)):t}function lt(t){let e=$.resolve(process.cwd(),".env"),o="utf8",r=Boolean(t&&t.debug),s=Boolean(t&&t.override);t&&(t.path!=null&&(e=pt(t.path)),t.encoding!=null&&(o=t.encoding));try{let n=m.parse(nt.readFileSync(e,{encoding:o}));return Object.keys(n).forEach(function(i){Object.prototype.hasOwnProperty.call(process.env,i)?(s===!0&&(process.env[i]=n[i]),r&&E(s===!0?`"${i}" is already defined in \`process.env\` and WAS overwritten`:`"${i}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[i]=n[i]}),{parsed:n}}catch(n){return r&&E(`Failed to load ${e} ${n.message}`),{error:n}}}var m={config:lt,parse:ct};u.exports.config=m.config;u.exports.parse=m.parse;u.exports=m});import{NativeAssetId as ft,Provider as dt,TestUtils as mt,Wallet as ut}from"fuels";function I(){return a(this,null,function*(){let{WALLET_SECRET:t,GENESIS_SECRET:e,PROVIDER_URL:o}=process.env;if(t)return p("WALLET_SECRET detected"),new ut(t,o);if(e){p("Funding wallet with some coins");let r=new dt(o);return mt.generateTestWallet(r,[[1e8,ft]])}throw new Error("You must provide a WALLET_SECRET or GENESIS_SECRET")})}var L=c(()=>{"use strict";b();F().config()});function y(t){return a(this,null,function*(){let e=yield I(),o=[];for(let{name:r,path:s,options:n}of t.contracts){let i;typeof n=="function"?i=n(o):typeof n=="object"&&(i=n),o.push({name:r,contractId:yield N(e,s,i)})}return o})}var j=c(()=>{"use strict";O();L()});function R(t){return a(this,null,function*(){return yield d(t),yield y(t)})}var W=c(()=>{"use strict";h();j()});function P(t){if(!Array.isArray(t.contracts))throw new Error("config.contract should be a valid array");if(typeof t.types.artifacts!="string")throw new Error("config.types.artifacts should be a valid string");if(typeof t.types.output!="string")throw new Error("config.types.output should be a valid string")}var q=c(()=>{"use strict"});import{bundleRequire as yt}from"bundle-require";import gt from"joycon";import wt from"path";function J(t){return a(this,null,function*(){let o=yield new gt().resolve({files:["pepaswap.config.js","pepaswap.config.ts"],cwd:t,stopDir:wt.parse(t).root,packageKey:"tsup"});if(o){let s=(yield yt({filepath:o})).mod.default;return s.env&&Object.assign(process.env,s.env),P(s),s}return{types:{artifacts:"",output:""},contracts:[]}})}var G=c(()=>{"use strict";q()});import{Command as Ct}from"commander";var M=C(U=>{"use strict";h();v();j();W();G();Q();var l=new Ct("pepaswap");function g(t,e){return()=>a(this,null,function*(){var r,s,n;let o=yield J(process.cwd());try{let i=yield e(o);(r=o.onSuccess)==null||r.call(o,{type:t,data:i})}catch(i){console.error((s=i==null?void 0:i.message)!=null?s:i),(n=o.onFailure)==null||n.call(o,i),process.exit()}})}l.name("PepaSwap Scripts").description("Utility to build, deploy and generate types for Pepa Contracts");l.command("build").description("Build pepa contracts and generate type").action(g("build",t=>a(U,null,function*(){return d(t)})));l.command("deploy").description("deploy contract to fuel network").action(g("deploy",t=>y(t)));l.command("run").description("build and deploy contracts to fuel network").action(g("run",t=>R(t)));l.command("types").description("Generate contract types").action(g("types",t=>f(t)));l.parse(process.argv)});M();
