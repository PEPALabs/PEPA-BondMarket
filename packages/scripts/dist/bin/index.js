#!/usr/bin/env node
"use strict";var pt=Object.create;var S=Object.defineProperty;var lt=Object.getOwnPropertyDescriptor;var dt=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,ft=Object.getPrototypeOf,R=Object.prototype.hasOwnProperty,ut=Object.prototype.propertyIsEnumerable;var F=(t,o,e)=>o in t?S(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,I=(t,o)=>{for(var e in o||(o={}))R.call(o,e)&&F(t,e,o[e]);if(L)for(var e of L(o))ut.call(o,e)&&F(t,e,o[e]);return t};var c=(t,o)=>()=>(t&&(o=t(t=0)),o);var j=(t,o)=>()=>(o||t((o={exports:{}}).exports,o),o.exports);var mt=(t,o,e,i)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of dt(o))!R.call(t,n)&&n!==e&&S(t,n,{get:()=>o[n],enumerable:!(i=lt(o,n))||i.enumerable});return t};var x=(t,o,e)=>(e=t!=null?pt(ft(t)):{},mt(o||!t||!t.__esModule?S(e,"default",{value:t,enumerable:!0}):e,t));var a=(t,o,e)=>new Promise((i,n)=>{var r=l=>{try{u(e.next(l))}catch(E){n(E)}},s=l=>{try{u(e.throw(l))}catch(E){n(E)}},u=l=>l.done?i(l.value):Promise.resolve(l.value).then(r,s);u((e=e.apply(t,o)).next())});function p(...t){console.log(...t)}var m=c(()=>{"use strict"});function _(t){return a(this,null,function*(){return p("Build",t),new Promise((o,e)=>{let i=(0,N.spawn)("forc",["build","-p",t],{stdio:"inherit"});p("Build"),i.on("exit",n=>{if(!n)return o(n);i.kill(),e()})})})}var N,$=c(()=>{"use strict";N=require("child_process");m()});function g(t){return a(this,null,function*(){let o=process.cwd();console.log(o),console.log(t);let e=(0,y.glob)(o,[t.types.artifacts]);yield(0,y.runTypeChain)({cwd:o,filesToProcess:e,allFiles:e,outDir:t.types.output,target:"fuels"})})}var y,D=c(()=>{"use strict";y=require("fuelchain")});function q(t){return a(this,null,function*(){return new Promise((o,e)=>{let i=(0,W.spawn)("node_modules/.bin/prettier",["--write",t.types.output.replace(/Ë†\.\//,"")],{stdio:"inherit"});i.on("exit",n=>{if(!n)return o(n);i.kill(),e()})})})}var W,P=c(()=>{"use strict";W=require("child_process")});function C(t){return a(this,null,function*(){console.log(t.contracts);for(let{path:o}of t.contracts)yield _(o);yield g(t),yield q(t)})}var k=c(()=>{"use strict";$();D();P()});function yt(t){return`/out/debug/${t.split("/").slice(-1)}.bin`}function gt(t){return`/out/debug/${t.split("/").slice(-1)}-abi.json`}function G(t,o,e){return a(this,null,function*(){if(!t)throw new Error("Cannot deploy without wallet");let i=A.default.join(o,yt(o)),n=A.default.join(o,gt(o));p("read binary file from: ",i);let r=(0,B.readFileSync)(i),s=JSON.parse((0,B.readFileSync)(n).toString()),u=new J.ContractFactory(r,s,t);p("deploy contract");let l=yield u.deployContract(I({gasLimit:1e6,storageSlots:[]},e));return p("contract successful deployed"),l.id.toB256()})}var B,J,A,U=c(()=>{"use strict";B=require("fs"),J=require("fuels"),A=x(require("path"));m()});var M=j((Gt,Ct)=>{Ct.exports={name:"dotenv",version:"16.0.3",description:"Loads environment variables from .env file",main:"lib/main.js",types:"lib/main.d.ts",exports:{".":{require:"./lib/main.js",types:"./lib/main.d.ts",default:"./lib/main.js"},"./config":"./config.js","./config.js":"./config.js","./lib/env-options":"./lib/env-options.js","./lib/env-options.js":"./lib/env-options.js","./lib/cli-options":"./lib/cli-options.js","./lib/cli-options.js":"./lib/cli-options.js","./package.json":"./package.json"},scripts:{"dts-check":"tsc --project tests/types/tsconfig.json",lint:"standard","lint-readme":"standard-markdown",pretest:"npm run lint && npm run dts-check",test:"tap tests/*.js --100 -Rspec",prerelease:"npm test",release:"standard-version"},repository:{type:"git",url:"git://github.com/motdotla/dotenv.git"},keywords:["dotenv","env",".env","environment","variables","config","settings"],readmeFilename:"README.md",license:"BSD-2-Clause",devDependencies:{"@types/node":"^17.0.9",decache:"^4.6.1",dtslint:"^3.7.0",sinon:"^12.0.1",standard:"^16.0.4","standard-markdown":"^7.1.0","standard-version":"^9.3.2",tap:"^15.1.6",tar:"^6.1.11",typescript:"^4.5.4"},engines:{node:">=12"}}});var K=j((Ut,v)=>{var wt=require("fs"),H=require("path"),vt=require("os"),bt=M(),ht=bt.version,Et=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/mg;function St(t){let o={},e=t.toString();e=e.replace(/\r\n?/mg,`
`);let i;for(;(i=Et.exec(e))!=null;){let n=i[1],r=i[2]||"";r=r.trim();let s=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/mg,"$2"),s==='"'&&(r=r.replace(/\\n/g,`
`),r=r.replace(/\\r/g,"\r")),o[n]=r}return o}function O(t){console.log(`[dotenv@${ht}][DEBUG] ${t}`)}function jt(t){return t[0]==="~"?H.join(vt.homedir(),t.slice(1)):t}function xt(t){let o=H.resolve(process.cwd(),".env"),e="utf8",i=Boolean(t&&t.debug),n=Boolean(t&&t.override);t&&(t.path!=null&&(o=jt(t.path)),t.encoding!=null&&(e=t.encoding));try{let r=w.parse(wt.readFileSync(o,{encoding:e}));return Object.keys(r).forEach(function(s){Object.prototype.hasOwnProperty.call(process.env,s)?(n===!0&&(process.env[s]=r[s]),i&&O(n===!0?`"${s}" is already defined in \`process.env\` and WAS overwritten`:`"${s}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[s]=r[s]}),{parsed:r}}catch(r){return i&&O(`Failed to load ${o} ${r.message}`),{error:r}}}var w={config:xt,parse:St};v.exports.config=w.config;v.exports.parse=w.parse;v.exports=w});function Q(){return a(this,null,function*(){let{WALLET_SECRET:t,GENESIS_SECRET:o,PROVIDER_URL:e}=process.env;if(t)return p("WALLET_SECRET detected"),new d.Wallet(t,e);if(o){p("Funding wallet with some coins");let i=new d.Provider(e);return d.TestUtils.generateTestWallet(i,[[1e8,d.NativeAssetId]])}throw new Error("You must provide a WALLET_SECRET or GENESIS_SECRET")})}var d,V=c(()=>{"use strict";d=require("fuels");m();K().config()});function b(t){return a(this,null,function*(){let o=yield Q(),e=[];for(let{name:i,path:n,options:r}of t.contracts){let s;typeof r=="function"?s=r(e):typeof r=="object"&&(s=r),e.push({name:i,contractId:yield G(o,n,s)})}return e})}var T=c(()=>{"use strict";U();V()});function Y(t){return a(this,null,function*(){return yield C(t),yield b(t)})}var z=c(()=>{"use strict";k();T()});function X(t){if(!Array.isArray(t.contracts))throw new Error("config.contract should be a valid array");if(typeof t.types.artifacts!="string")throw new Error("config.types.artifacts should be a valid string");if(typeof t.types.output!="string")throw new Error("config.types.output should be a valid string")}var Z=c(()=>{"use strict"});function nt(t){return a(this,null,function*(){let e=yield new ot.default().resolve({files:["pepaswap.config.js","pepaswap.config.ts"],cwd:t,stopDir:et.default.parse(t).root,packageKey:"tsup"});if(e){let n=(yield(0,tt.bundleRequire)({filepath:e})).mod.default;return n.env&&Object.assign(process.env,n.env),X(n),n}return{types:{artifacts:"",output:""},contracts:[]}})}var tt,ot,et,rt=c(()=>{"use strict";tt=require("bundle-require"),ot=x(require("joycon")),et=x(require("path"));Z()});var it=c(()=>{"use strict"});var ct=j(at=>{"use strict";var st=require("commander");k();D();T();z();rt();it();var f=new st.Command("pepaswap");function h(t,o){return()=>a(this,null,function*(){var i,n,r;let e=yield nt(process.cwd());try{let s=yield o(e);(i=e.onSuccess)==null||i.call(e,{type:t,data:s})}catch(s){console.error((n=s==null?void 0:s.message)!=null?n:s),(r=e.onFailure)==null||r.call(e,s),process.exit()}})}f.name("PepaSwap Scripts").description("Utility to build, deploy and generate types for Pepa Contracts");f.command("build").description("Build pepa contracts and generate type").action(h("build",t=>a(at,null,function*(){return C(t)})));f.command("deploy").description("deploy contract to fuel network").action(h("deploy",t=>b(t)));f.command("run").description("build and deploy contracts to fuel network").action(h("run",t=>Y(t)));f.command("types").description("Generate contract types").action(h("types",t=>g(t)));f.parse(process.argv)});ct();
